<!DOCTYPE html>
<html>
<head>
  <script src="https://sdk.twilio.com/js/voice/latest/twilio.min.js"></script>
</head>
<body>

<h3>ClickUp Dialer</h3>

<input type="text" id="phoneNumber" placeholder="+15557771234">
<button id="callBtn">Call</button>

<script>
let device;

async function init() {
  const response = await fetch("https://clickup-dialer-4911.twil.io/token?identity=agent1");
  const data = await response.json();

  device = new Twilio.Device(data.token);

  device.on("ready", () => {
    console.log("Device ready");
  });

  device.on("error", (error) => {
    console.error("Device error:", error);
  });
}

document.getElementById("callBtn").onclick = function () {
  const number = document.getElementById("phoneNumber").value;

  if (!device) {
    console.error("Device not initialized");
    return;
  }

  device.connect({
    params: { To: number }
  });
};

init();
</script>

</body>
</html>
